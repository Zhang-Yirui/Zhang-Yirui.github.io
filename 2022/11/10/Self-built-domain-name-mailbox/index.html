<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="keywords" content="小张的笔记"><meta name="author" content="静凇"><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><link rel="canonical" href="https://blog.zhangyirui.cn/2022/11/10/self-built-domain-name-mailbox/"><meta name="robots" content="index,follow"><meta name="googlebot" content="index,follow"><meta name="revisit-after" content="1 days"><meta name="description" content="本文是在 Ubuntu 22.04 中使用 Docker 安装 Mailcow 搭建自建邮箱的教程。         本教程同时适用于其他可安装 Docker 的 Linux 发行版。     什么是电子邮箱？  电子邮箱，即电子邮件，就是 Email，是指一种由一寄件人将数字信息发送给一个人或多个人的信息交换方式，一般会通过互联网或其他电脑网络进行书写、发送和接收信件，目的是达成发信人和收信人之"><meta property="og:type" content="article"><meta property="og:title" content="Ubuntu 22.04 使用 Docker 安装 Mailcow 自建域名邮箱"><meta property="og:url" content="https://blog.zhangyirui.cn/2022/11/10/Self-built-domain-name-mailbox/index.html"><meta property="og:site_name" content="小张的笔记"><meta property="og:description" content="本文是在 Ubuntu 22.04 中使用 Docker 安装 Mailcow 搭建自建邮箱的教程。         本教程同时适用于其他可安装 Docker 的 Linux 发行版。     什么是电子邮箱？  电子邮箱，即电子邮件，就是 Email，是指一种由一寄件人将数字信息发送给一个人或多个人的信息交换方式，一般会通过互联网或其他电脑网络进行书写、发送和接收信件，目的是达成发信人和收信人之"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://note.zhangyirui.cn/images/Self-built-domain-name-mailbox/image1.png"><meta property="og:image" content="https://note.zhangyirui.cn/images/Self-built-domain-name-mailbox/image2.png"><meta property="og:image" content="https://note.zhangyirui.cn/images/Self-built-domain-name-mailbox/image3.png"><meta property="og:image" content="https://note.zhangyirui.cn/images/Self-built-domain-name-mailbox/image4.png"><meta property="og:image" content="https://note.zhangyirui.cn/images/Self-built-domain-name-mailbox/image5.png"><meta property="og:image" content="https://note.zhangyirui.cn/images/Self-built-domain-name-mailbox/image6.png"><meta property="og:image" content="https://note.zhangyirui.cn/images/Self-built-domain-name-mailbox/image7.png"><meta property="og:image" content="https://note.zhangyirui.cn/images/Self-built-domain-name-mailbox/image8.png"><meta property="og:image" content="https://note.zhangyirui.cn/images/Self-built-domain-name-mailbox/image9.png"><meta property="og:image" content="https://note.zhangyirui.cn/images/Self-built-domain-name-mailbox/image10.png"><meta property="og:image" content="https://note.zhangyirui.cn/images/Self-built-domain-name-mailbox/image11.png"><meta property="og:image" content="https://note.zhangyirui.cn/images/Self-built-domain-name-mailbox/image12.png"><meta property="og:image" content="https://note.zhangyirui.cn/images/Self-built-domain-name-mailbox/image13.png"><meta property="article:published_time" content="2022-11-10T12:08:23.000Z"><meta property="article:modified_time" content="2024-10-25T01:45:38.004Z"><meta property="article:author" content="静凇"><meta property="article:tag" content="Ubuntu"><meta property="article:tag" content="Mailcow"><meta property="article:tag" content="自建邮箱"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://note.zhangyirui.cn/images/Self-built-domain-name-mailbox/image1.png"><link rel="icon" type="image/png" href="/images/R-favicon.svg" sizes="192x192"><link rel="apple-touch-icon" sizes="180x180" href="/images/R-favicon.svg"><meta name="theme-color" content="#A31F34"><link rel="shortcut icon" href="/images/R-favicon.svg"><title>Ubuntu 22.04 使用 Docker 安装 Mailcow 自建域名邮箱 - 小张的笔记</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.7.1/source/fonts/Chillax/chillax.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.7.1/source/assets/build/styles.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.7.1/source/fonts/GeistMono/geist-mono.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.7.1/source/fonts/Geist/geist.css"><script src="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.7.1/source/js/libs/anime.min.js"></script><script id="hexo-configurations">window.config={hostname:"blog.zhangyirui.cn",root:"/",language:"zh-CN"},window.theme={articles:{style:{font_size:"16px",line_height:1.5,image_border_radius:"14px",image_alignment:"center",image_caption:!1,link_icon:!0,title_alignment:"left",headings_top_spacing:{h1:"3.2rem",h2:"2.4rem",h3:"1.9rem",h4:"1.6rem",h5:"1.4rem",h6:"1.3rem"}},word_count:{enable:!0,count:!0,min2read:!0},author_label:{enable:!0,auto:!1,list:[]},code_block:{copy:!0,style:"mac",highlight_theme:{light:"github",dark:"vs2015"},font:{enable:!1,family:null,url:null}},toc:{enable:!0,max_depth:3,number:!1,expand:!0,init_open:!0},copyright:{enable:!0,default:"cc_by_nc_sa"},lazyload:!0,recommendation:{enable:!1,title:"推荐阅读",limit:3,mobile_limit:2,placeholder:"/images/wallhaven-wqery6-light.webp",skip_dirs:[]}},colors:{primary:"#A31F34",secondary:null,default_mode:"light"},global:{fonts:{chinese:{enable:!1,family:null,url:null},english:{enable:!1,family:null,url:null},title:{enable:!1,family:null,url:null}},content_max_width:"1000px",sidebar_width:"210px",hover:{shadow:!0,scale:!0},scroll_progress:{bar:!0,percentage:!0},website_counter:{url:"https://cn.vercount.one/js",enable:!0,site_pv:!0,site_uv:!0,post_pv:!0},single_page:!0,preloader:!0,open_graph:!0,google_analytics:{enable:!1,id:null}},home_banner:{enable:!0,style:"fixed",image:{light:"/images/wallhaven-wqery6-light.webp",dark:"/images/wallhaven-wqery6-dark.webp"},title:"我们是自己生活的主宰，也是茫茫宇宙中的一粒尘埃。",subtitle:{text:["嗨，别来无恙啊！","二〇二四年 九月(小) 廿三 星期五 甲辰龙年 甲戌月 壬戌日 霜降 距离立冬还有-17天"],hitokoto:{enable:!1,show_author:!1,api:"https://v1.hitokoto.cn"},typing_speed:100,backing_speed:33,starting_delay:500,backing_delay:2e3,loop:!0,smart_backspace:!0},text_color:{light:"#fff",dark:"#d1d1b6"},text_style:{title_size:"2.8rem",subtitle_size:"1.5rem",line_height:1.2},custom_font:{enable:!1,family:null,url:null},social_links:{enable:!0,style:"center",links:{github:"https://github.com/Zhang-Yirui",instagram:null,zhihu:null,twitter:null,email:"jingsong5683@gmail.com",telegram:"https://t.me/jingsong88",bilibili:"https://space.bilibili.com/95907216"},qrs:{weixin:"/images/qrs_wx.png",qq:"/images/qrs_qq.png"}}},plugins:{feed:{enable:!1},aplayer:{enable:!0,type:"fixed",audios:[{name:"无名的人",artist:"毛不易",url:"/musics/无名的人-毛不易.mp3",cover:"/images/cover/无名的人-毛不易.webp",lrc:null},{name:"起风了",artist:"买辣椒也用券",url:"/musics/起风了-买辣椒也用券.mp3",cover:"/images/cover/起风了-买辣椒也用券.jpg",lrc:"/musics/lrc/起风了-买辣椒也用券.lrc"}]},mermaid:{enable:!0,version:"9.3.0"}},version:"2.7.1",navbar:{auto_hide:!1,color:{left:"#f78736",right:"#367df7",transparency:35},width:{home:"1200px",pages:"1000px"},links:{Home:{path:"/",icon:"fa-regular fa-house"}},search:{enable:!1,preload:!0}},page_templates:{friends_column:2,tags_style:"blur"},home:{sidebar:{enable:!0,position:"left",first_item:"menu",announcement:"我的生活我做主",show_on_mobile:!0,links:{Archives:{path:"/archives",icon:"fa-regular fa-archive"}}},article_date_format:"YYYY-MM-DD HH:mm:ss",excerpt_length:200,categories:{enable:!0,limit:3},tags:{enable:!0,limit:3}},footerStart:"2022/10/1 00:00:00"},window.lang_ago={second:"%s 秒前",minute:"%s 分钟前",hour:"%s 小时前",day:"%s 天前",week:"%s 周前",month:"%s 个月前",year:"%s 年前"},window.data={masonry:!1}</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.7.1/source/fontawesome/fontawesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.7.1/source/fontawesome/brands.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.7.1/source/fontawesome/solid.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.7.1/source/fontawesome/regular.min.css"><meta name="generator" content="Hexo 7.3.0"></head><body><div class="progress-bar-container"><span class="scroll-progress-bar"></span> <span class="pjax-progress-bar"></span></div><style>:root{--preloader-background-color:#fff;--preloader-text-color:#000}@media (prefers-color-scheme:dark){:root{--preloader-background-color:#202124;--preloader-text-color:#fff}}@media (prefers-color-scheme:light){:root{--preloader-background-color:#fff;--preloader-text-color:#000}}@media (max-width:600px){.ml13{font-size:2.6rem!important}}.preloader{display:flex;flex-direction:column;gap:1rem;align-items:center;justify-content:center;position:fixed;padding:12px;top:0;right:0;bottom:0;left:0;width:100vw;height:100vh;background-color:var(--preloader-background-color);z-index:1100;transition:opacity .2s ease-in-out}.ml13{font-size:3.2rem;color:var(--preloader-text-color);letter-spacing:-1px;font-weight:500;font-family:Chillax-Variable,sans-serif;text-align:center}.ml13 .word{display:inline-flex;flex-wrap:wrap;white-space:nowrap}.ml13 .letter{display:inline-block;line-height:1em}</style><div class="preloader"><h2 class="ml13">小张的笔记</h2><script>var textWrapper = document.querySelector('.ml13');
        // Split text into words
        var words = textWrapper.textContent.trim().split(' ');

        // Clear the existing content
        textWrapper.innerHTML = '';

        // Wrap each word and its letters in spans
        words.forEach(function(word) {
            var wordSpan = document.createElement('span');
            wordSpan.classList.add('word');
            wordSpan.innerHTML = word.replace(/\S/g, "<span class='letter'>$&</span>");
            textWrapper.appendChild(wordSpan);
            textWrapper.appendChild(document.createTextNode(' ')); // Add space between words
        });

        var animation = anime.timeline({loop: true})
            .add({
                targets: '.ml13 .letter',
                translateY: [40,0],
                translateZ: 0,
                opacity: [0,1],
                filter: ['blur(5px)', 'blur(0px)'], // Starting from blurred to unblurred
                easing: "easeOutExpo",
                duration: 1400,
                delay: (el, i) => 300 + 30 * i,
            }).add({
                targets: '.ml13 .letter',
                translateY: [0,-40],
                opacity: [1,0],
                filter: ['blur(0px)', 'blur(5px)'], // Ending from unblurred to blurred
                easing: "easeInExpo",
                duration: 1200,
                delay: (el, i) => 100 + 30 * i,
                complete: function() {
                    hidePreloader(); // Call hidePreloader after the animation completes
                }
            });

        let themeStatus = JSON.parse(localStorage.getItem('REDEFINE-THEME-STATUS'))?.isDark;

        // If the theme status is not found in local storage, check the preferred color scheme
        if (themeStatus === undefined || themeStatus === null) {
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                themeStatus = 'dark';
            } else {
                themeStatus = 'light';
            }
        }

        // Now you can use the themeStatus variable in your code
        if (themeStatus) {
            document.documentElement.style.setProperty('--preloader-background-color', '#202124');
            document.documentElement.style.setProperty('--preloader-text-color', '#fff');
        } else {
            document.documentElement.style.setProperty('--preloader-background-color', '#fff');
            document.documentElement.style.setProperty('--preloader-text-color', '#000');
        }

        window.addEventListener('load', function () {
            setTimeout(hidePreloader, 5000); // Call hidePreloader after 5000 milliseconds if not already called by animation
        });

        function hidePreloader() {
            var preloader = document.querySelector('.preloader');
            preloader.style.opacity = '0';
            setTimeout(function () {
                preloader.style.display = 'none';
            }, 200);
        }</script></div><main class="page-container" id="swup"><div class="main-content-container"><div class="main-content-header"><header class="navbar-container px-6 md:px-12"><div class="navbar-content"><div class="left"><a class="logo-image" href="/"><img src="/images/R-logo.svg"> </a><a class="logo-title" href="/">小张的笔记</a></div><div class="right"><div class="desktop"><ul class="navbar-list"><li class="navbar-item"><a href="/"><i class="fa-regular fa-house fa-fw"></i> 首页</a></li></ul></div><div class="mobile"><div class="icon-item navbar-bar"><div class="navbar-bar-middle"></div></div></div></div></div><div class="navbar-drawer h-screen w-full absolute top-0 left-0 bg-background-color flex flex-col justify-between"><ul class="drawer-navbar-list flex flex-col px-4 justify-center items-start"><li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full"><a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full" href="/"><span>首页 </span><i class="fa-regular fa-house fa-sm fa-fw"></i></a></li><li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full"><a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full active" href="/archives"><span>Archives</span> <i class="fa-regular fa-archive fa-sm fa-fw"></i></a></li></ul><div class="statistics flex justify-around my-2.5"><a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/tags"><div class="number text-2xl sm:text-xl text-second-text-color font-semibold">19</div><div class="label text-third-text-color text-sm">标签</div></a><a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/categories"><div class="number text-2xl sm:text-xl text-second-text-color font-semibold">0</div><div class="label text-third-text-color text-sm">分类</div></a><a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/archives"><div class="number text-2xl sm:text-xl text-second-text-color font-semibold">12</div><div class="label text-third-text-color text-sm">文章</div></a></div></div><div class="window-mask"></div></header></div><div class="main-content-body"><div class="main-content"><div class="post-page-container flex relative justify-between box-border w-full h-full"><div class="article-content-container"><div class="article-title relative w-full"><div class="w-full flex items-center pt-6 justify-start"><h1 class="article-title-regular text-second-text-color tracking-tight text-4xl md:text-6xl font-semibold px-2 sm:px-6 md:px-8 py-3">Ubuntu 22.04 使用 Docker 安装 Mailcow 自建域名邮箱</h1></div></div><div class="article-header flex flex-row gap-2 items-center px-2 sm:px-6 md:px-8"><div class="avatar w-[46px] h-[46px] flex-shrink-0 rounded-medium border border-border-color p-[1px]"><img src="/images/R-avatar.svg"></div><div class="info flex flex-col justify-between"><div class="author flex items-center"><span class="name text-default-text-color text-lg font-semibold">静凇</span> <span class="author-label ml-1.5 text-xs px-2 py-0.5 rounded-small text-third-text-color border border-shadow-color-1">Lv2</span></div><div class="meta-info"><div class="article-meta-info"><span class="article-date article-meta-item"><i class="fa-regular fa-pen-fancy"></i>&nbsp; <span class="desktop">2022-11-10 20:08:23</span> <span class="mobile">2022-11-10 20:08:23</span> <span class="hover-info">创建</span> </span><span class="article-date article-meta-item"><i class="fa-regular fa-wrench"></i>&nbsp; <span class="desktop">2024-10-25 09:45:38</span> <span class="mobile">2024-10-25 09:45:38</span> <span class="hover-info">更新</span> </span><span class="article-tags article-meta-item"><i class="fa-regular fa-tags"></i>&nbsp;<ul><li><a href="/tags/Ubuntu/">Ubuntu</a>&nbsp;</li><li>| <a href="/tags/Mailcow/">Mailcow</a>&nbsp;</li><li>| <a href="/tags/%E8%87%AA%E5%BB%BA%E9%82%AE%E7%AE%B1/">自建邮箱</a>&nbsp;</li></ul></span><span class="article-pv article-meta-item"><i class="fa-regular fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span></span></div></div></div></div><div class="article-content markdown-body px-2 sm:px-6 md:px-8 pb-8"><h2 id="本文是在-ubuntu-22.04-中使用-docker-安装-mailcow-搭建自建邮箱的教程">本文是在 Ubuntu 22.04 中使用 Docker 安装 Mailcow 搭建自建邮箱的教程。</h2><div class="note p-4 mb-4 rounded-small default"><p>本教程同时适用于其他可安装 Docker 的 Linux 发行版。</p></div><h3 id="什么是电子邮箱">什么是电子邮箱？</h3><hr><p>电子邮箱，即电子邮件，就是 Email，是指一种由一寄件人将数字信息发送给一个人或多个人的信息交换方式，一般会通过互联网或其他电脑网络进行书写、发送和接收信件，目的是达成发信人和收信人之间的信息交互。一些早期的电子邮件需要寄件人和收件人同时在线，类似即时通信。(来自<a class="link" target="_blank" rel="noopener" href="https://zh.wikipedia.org/zh-cn/电子邮件">Wikipedia <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>)</p><p>国内用户一般会使用网易 (<span class="citation" data-cites="163.com">@163.com</span>)、腾讯 (<span class="citation" data-cites="qq.com">@qq.com</span>) 等免费邮箱服务，国外用户一般会使用 Google (<span class="citation" data-cites="gmail.com">@gmail.com</span>)、Yahoo (<span class="citation" data-cites="yahoo.com">@yahoo.com</span>)、Microsoft (<span class="citation" data-cites="outlook.com">@outlook.com</span>) 等免费服务。</p><h2 id="为什么要自建邮箱">为什么要自建邮箱？</h2><p>首先，你的数据是你自己的，你的隐私应当得到保护，而不是那些垄断巨头公司的，几乎所有市面上的免费邮箱服务，都是以牺牲你的隐私和数据为代价，利用你的大数据来进行广告行为分析来盈利，那么，你愿意把你自己的数据交付给和你素不相识的第三方么？</p><p>其次，看本博客的读者，几乎人手一个域名，人手一只 VPS，那为何不把现有资源利用起来做一些很酷的事情呢？</p><h2 id="自建邮箱的优势和劣势">自建邮箱的优势和劣势</h2><p>那么，会有小伙伴指出，市面上也有收费的邮箱呀，比如国内一些大厂的 “企业邮箱”，为什么不用收费服务呢？我们就自建邮箱，免费邮箱和收费邮箱做一个简单的表格对比：</p><table><thead><tr><th style="text-align:center">对比</th><th style="text-align:center">自建邮箱</th><th style="text-align:center">免费邮箱</th><th style="text-align:center">收费邮箱</th></tr></thead><tbody><tr><td style="text-align:center">隐私性</td><td style="text-align:center">高</td><td style="text-align:center">低</td><td style="text-align:center">中</td></tr><tr><td style="text-align:center">维护难度</td><td style="text-align:center">高</td><td style="text-align:center">低</td><td style="text-align:center">低</td></tr><tr><td style="text-align:center">价格</td><td style="text-align:center">中</td><td style="text-align:center">无</td><td style="text-align:center">中 - 高</td></tr><tr><td style="text-align:center">使用成本</td><td style="text-align:center">高</td><td style="text-align:center">无</td><td style="text-align:center">中</td></tr><tr><td style="text-align:center">隐性成本*</td><td style="text-align:center">中</td><td style="text-align:center">极高</td><td style="text-align:center">高</td></tr></tbody></table><p>着重指出一下我所强调的隐性成本：</p><p>因为免费和收费的邮箱服务，你的数据都是保存在第三方，你没有服务器的权限，你的帐号都是别人服务器里的冷冰冰的数据库，那么，你邮箱的提供商可以：</p><ol type="1"><li>随时用各种理由关停你的服务，无论是合法的还是莫须有的原因，比如这里的<a class="link" target="_blank" rel="noopener" href="https://news.ycombinator.com/item?id=24254484">例子 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></li><li>随时把你的资料卖给第三方，你作为最终用户是不可能知道的，比如？</li><li>随时面临倒闭关门从而永久丢失数据的风险，比如曾经的雅虎中文邮箱。</li></ol><p>这些成本是你使用第三方服务的时候可能没有考虑过的，而自建邮箱服务的话，这个隐性成本我们是可控的：</p><ol type="1"><li>你可以控制你的域名，只要选对有良好信誉的注册局和注册商，每年稳定续费并不做违反 ToS 的事情，域名一般不会被强制暂停；</li><li>你可以选择你的服务器供应商，只要选对有良好信誉的供应商，每月稳定续费并不做违反 ToS 的事情，服务器一般不会被强制暂停；</li><li>你可以每天备份你的数据，自己做数据容灾备份，不丢失任何重要的资料。</li></ol><h2 id="自建邮箱需要准备的资料">自建邮箱需要准备的资料</h2><p>首先，你需要有一个你 “完全拥有使用权限” 的 “国际化” 的域名，我们不推荐使用任何小国家的国别后缀，不然哪天你域名怎么没的都不知道，这里主要还是推荐如下几个稳如狗的 gTLD 后缀：</p><ul><li>.com</li><li>.net</li><li>.org</li></ul><p>其次，你需要一台服务器或 KVM / Xen 构架的 VPS，按照官网的<a class="link" target="_blank" rel="noopener" href="https://docs.mailcow.email/prerequisite/prerequisite-system/#minimum-system-resources">说法 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>，推荐的最小配置要求如下：</p><table><thead><tr><th>Resource</th><th>mailcow: dockerized</th></tr></thead><tbody><tr><td>CPU</td><td>1 GHz</td></tr><tr><td>内存</td><td><strong>最低</strong> 6 GiB + 1 GiB swap (实际测试 4 GiB 内存也足够)</td></tr><tr><td>硬盘</td><td>20 GiB (不包含邮件的占用)</td></tr><tr><td>系统</td><td>x86_64</td></tr></tbody></table><p>并且从防火墙放行这几个 TCP 端口：</p><table><thead><tr><th>服务</th><th style="text-align:center">协议</th><th style="text-align:left">端口</th><th style="text-align:left">容器名</th></tr></thead><tbody><tr><td>Postfix SMTP</td><td style="text-align:center">TCP</td><td style="text-align:left">25</td><td style="text-align:left">postfix-mailcow</td></tr><tr><td>Postfix SMTPS</td><td style="text-align:center">TCP</td><td style="text-align:left">465</td><td style="text-align:left">postfix-mailcow</td></tr><tr><td>Postfix Submission</td><td style="text-align:center">TCP</td><td style="text-align:left">587</td><td style="text-align:left">postfix-mailcow</td></tr><tr><td>Dovecot IMAP</td><td style="text-align:center">TCP</td><td style="text-align:left">143</td><td style="text-align:left">dovecot-mailcow</td></tr><tr><td>Dovecot IMAPS</td><td style="text-align:center">TCP</td><td style="text-align:left">993</td><td style="text-align:left">dovecot-mailcow</td></tr><tr><td>Dovecot POP3</td><td style="text-align:center">TCP</td><td style="text-align:left">110</td><td style="text-align:left">dovecot-mailcow</td></tr><tr><td>Dovecot POP3S</td><td style="text-align:center">TCP</td><td style="text-align:left">995</td><td style="text-align:left">dovecot-mailcow</td></tr><tr><td>Dovecot ManageSieve</td><td style="text-align:center">TCP</td><td style="text-align:left">4190</td><td style="text-align:left">dovecot-mailcow</td></tr><tr><td>HTTP(S)</td><td style="text-align:center">TCP</td><td style="text-align:left">80/443</td><td style="text-align:left">nginx-mailcow</td></tr></tbody></table><div class="note p-4 mb-4 rounded-small warning"><p>请注意，因为垃圾邮件滥用的原因，很多国外的 VPS 商家并不允许架设邮件发送服务器，并且默认 25 端口的出口方向是屏蔽的，请自行咨询厂商。</p></div><h2 id="安装-docker-和-docker-compose">安装 Docker 和 Docker Compose</h2><p>请参考<a href="">本站教程</a>。</p><h2 id="设置-dns-解析记录">设置 DNS 解析记录</h2><p>我们假设你的邮箱服务器需要使用域名 <code>mail.example.com</code>，你想搭建 <code>username@example.com</code> 的邮箱；</p><p>然后你的服务器 IPv4 为 <code>192.0.2.25</code>，IPv6 为 <code>2001:db8::25</code>，那么请预先做好如下解析：</p><table><colgroup><col style="width:51%"><col style="width:6%"><col style="width:41%"></colgroup><thead><tr><th>域名</th><th>解析类型</th><th>解析值</th></tr></thead><tbody><tr><td><a class="link" target="_blank" rel="noopener" href="http://mail.example.com/">mail.example.com <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></td><td>A</td><td>192.0.2.25</td></tr><tr><td><a class="link" target="_blank" rel="noopener" href="http://mail.example.com/">mail.example.com <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></td><td>AAAA</td><td>2001:db8::25</td></tr><tr><td><a class="link" target="_blank" rel="noopener" href="http://example.com/">example.com <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></td><td>MX</td><td>10 <a class="link" target="_blank" rel="noopener" href="http://mail.example.com/">mail.example.com <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>.</td></tr><tr><td><a class="link" target="_blank" rel="noopener" href="http://example.com/">example.com <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></td><td>TXT</td><td>"v=spf1 mx ~all"</td></tr><tr><td>_dmarc.example.com</td><td>TXT</td><td>"v=DMARC1; p=reject; sp=reject; adkim=s; aspf=s;"</td></tr><tr><td><a class="link" target="_blank" rel="noopener" href="http://autodiscover.example.com/">autodiscover.example.com <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></td><td>CNAME</td><td><a class="link" target="_blank" rel="noopener" href="http://mail.example.com/">mail.example.com <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>.</td></tr><tr><td><a class="link" target="_blank" rel="noopener" href="http://autoconfig.example.com/">autoconfig.example.com <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></td><td>CNAME</td><td><a class="link" target="_blank" rel="noopener" href="http://mail.example.com/">mail.example.com <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>.</td></tr></tbody></table><p><strong>请注意某些 DNS 厂商的控制面板添加 MX 和 CNAME 记录时不需要输入最后的点号，添加 TXT 记录时不需要最前面和最后面的引号。</strong></p><p>另外需要联系你的 VPS 厂商，设置 PTR 记录，即 IP 反向解析，请设置 <code>192.0.2.25</code> 和 <code>2001:db8::25</code> 的 PTR 记录为 <code>mail.example.com.</code> 提高邮件到达率。</p><h2 id="安装-mailcow">安装 Mailcow</h2><p>首先我们获取 Mailcow 的安装代码：</p><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">apt install git -y</span><br><span class="line"><span class="built_in">cd</span> /opt</span><br><span class="line">git <span class="built_in">clone</span> https://github.com/mailcow/mailcow-dockerized</span><br><span class="line"><span class="built_in">cd</span> mailcow-dockerized</span><br></pre></td></tr></table></figure></div><p>然后生成配置文件，请注意使用 FQDN (比如 <code>mail.example.com</code>) 作为 hostname：</p><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash generate_config.sh</span><br></pre></td></tr></table></figure></div><p>按照提示输入自己的需求后即可生成好配置文件 <code>mailcow.conf</code>，如有需要可以自己修改这个文件。</p><p>然后拉取 Docker 镜像并启动</p><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker compose pull</span><br><span class="line">docker compose up -d</span><br></pre></td></tr></table></figure></div><p>耐心等待几分钟后即可访问 <code>https://mail.example.com/</code> 默认用户名 <code>admin</code> 默认密码 <code>moohoo</code>，建议立马修改并开启 2FA 两步验证确保安全。</p><h2 id="添加域名和邮箱">添加域名和邮箱</h2><p>进入 Mailcow 后台后，我们可以在顶部的 <code>Configuration</code> &gt; <code>Mail Setup</code> 里添加域名</p><figure><img lazyload src="/images/loading.svg" data-src="https://note.zhangyirui.cn/images/Self-built-domain-name-mailbox/image1.png" alt="image1.png"><figcaption aria-hidden="true">image1.png</figcaption></figure><p>在左侧的 <code>Domains</code> tab 里选择 <code>+Add domain</code> 添加域名：</p><figure><img lazyload src="/images/loading.svg" data-src="https://note.zhangyirui.cn/images/Self-built-domain-name-mailbox/image2.png" alt="image2.png"><figcaption aria-hidden="true">image2.png</figcaption></figure><p>按照自己的要求填入各种设置：</p><figure><img lazyload src="/images/loading.svg" data-src="https://note.zhangyirui.cn/images/Self-built-domain-name-mailbox/image3.png" alt="image3.png"><figcaption aria-hidden="true">image3.png</figcaption></figure><p>如果需要立马生效 Web 客户端，可以选择 <code>Add domain and restart SOGo</code>：</p><figure><img lazyload src="/images/loading.svg" data-src="https://note.zhangyirui.cn/images/Self-built-domain-name-mailbox/image4.png" alt="image4.png"><figcaption aria-hidden="true">image4.png</figcaption></figure><h2 id="开启-dkim-并添加-dns-记录">开启 DKIM 并添加 DNS 记录</h2><p>开启 DKIM 后邮件发信到达率更高，你可以登录 Mailcow 后台后在 <code>Configuration</code> &gt; <code>ARC/DKIM keys</code> 查看你域名的 dkim 记录值：</p><figure><img lazyload src="/images/loading.svg" data-src="https://note.zhangyirui.cn/images/Self-built-domain-name-mailbox/image5.png" alt="image5.png"><figcaption aria-hidden="true">image5.png</figcaption></figure><p>右边那一串 <code>v=DKIM1;k=rsa;t=s;s=email;p=</code> 的 2048 位字符即你的 DKIM 值，如果未开启，可以在下方输入域名，选择 2048 位，然后点 <code>+ Add</code> 按钮添加</p><figure><img lazyload src="/images/loading.svg" data-src="https://note.zhangyirui.cn/images/Self-built-domain-name-mailbox/image6.png" alt="image6.png"><figcaption aria-hidden="true">image6.png</figcaption></figure><p>默认添加完域名后即开启了 DKIM，且 <code>Selector</code> 设置为 <code>dkim</code>，然后我们需要添加如下 DNS 记录：</p><table><colgroup><col style="width:32%"><col style="width:9%"><col style="width:57%"></colgroup><thead><tr><th>域名</th><th>解析类型</th><th>解析值</th></tr></thead><tbody><tr><td>dkim._domainkey.example.com</td><td>TXT</td><td>"v=DKIM1;k=rsa;t=s;s=email;p=blablablablablabla"</td></tr></tbody></table><p><strong>某些 DNS 厂商的后台可能无法直接添加 2048 位 DKIM 的 TXT 记录，因为 TXT 类型的 DNS 记录最大长度为 255 个字符，那么请手工截断成两个 TXT 记录，第一个需要 255 个字符，第二个记录为剩下的字符串</strong></p><h2 id="添加邮箱用户">添加邮箱用户</h2><p>我们可以在 <code>Mailboxes</code> 这个 tab 里选择 <code>+Add mailbox</code> 按钮添加用户：</p><figure><img lazyload src="/images/loading.svg" data-src="https://note.zhangyirui.cn/images/Self-built-domain-name-mailbox/image7.png" alt="image7.png"><figcaption aria-hidden="true">image7.png</figcaption></figure><p>按要求提示填写即可：</p><figure><img lazyload src="/images/loading.svg" data-src="https://note.zhangyirui.cn/images/Self-built-domain-name-mailbox/image8.png" alt="image8.png"><figcaption aria-hidden="true">image8.png</figcaption></figure><h2 id="测试邮件">测试邮件</h2><p>我们使用刚开的用户登录 Mailcow 自带的 SOGo，默认情况下地址为 <code>https://mail.example.com/SOGo/</code></p><p>首先，测试接受邮件，使用任何外部邮箱给 <code>username@example.com</code> 发一封邮件，看看是否正常收到邮件。</p><p>然后我们测试发送邮件，在 <a class="link" target="_blank" rel="noopener" href="https://www.mail-tester.com/">mail-tester.com <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a> 发送一封 <code>Plain Text</code> 格式的测试邮件，稍等片刻后即可查看你的邮件分数，我们可以看到，严格按照本文教程搭建的自建邮箱服务评分可以是 10 分：</p><figure><img lazyload src="/images/loading.svg" data-src="https://note.zhangyirui.cn/images/Self-built-domain-name-mailbox/image9.png" alt="image9.png"><figcaption aria-hidden="true">image9.png</figcaption></figure><h2 id="mailcow-的更新和备份">Mailcow 的更新和备份</h2><p>Mailcow 的更新只需执行 <code>update.sh</code> 脚本即可：</p><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /opt/mailcow-dockerized</span><br><span class="line">./update.sh</span><br></pre></td></tr></table></figure></div><p>按照提示更新仓库文件：</p><figure><img lazyload src="/images/loading.svg" data-src="https://note.zhangyirui.cn/images/Self-built-domain-name-mailbox/image10.png" alt="image10.png"><figcaption aria-hidden="true">image10.png</figcaption></figure><p>然后再次执行 <code>./update.sh</code> 更新 Mailcow，提供提示 <code>Are you sure you want to update mailcow: dockerized? All containers will be stopped. [y/N]</code> 输入 <code>y</code> 然后按回车：</p><figure><img lazyload src="/images/loading.svg" data-src="https://note.zhangyirui.cn/images/Self-built-domain-name-mailbox/image11.png" alt="image11.png"><figcaption aria-hidden="true">image11.png</figcaption></figure><p>然后耐心等待 Docker 更新并重启容器，并且可以选择删除旧的容器：</p><figure><img lazyload src="/images/loading.svg" data-src="https://note.zhangyirui.cn/images/Self-built-domain-name-mailbox/image12.png" alt="image12.png"><figcaption aria-hidden="true">image12.png</figcaption></figure><p>你也可以使用 <code>docker system prune</code> 命令清除无用的 Docker 镜像。</p><p>Mailcow 的备份也自带脚本，我们只需进入目录执行 <code>./helper-scripts/backup_and_restore.sh</code> 即可：</p><p>假设你需要备份到 <code>/opt/backup</code> 目录</p><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /opt/mailcow-dockerized</span><br><span class="line">MAILCOW_BACKUP_LOCATION=/opt/backup</span><br><span class="line">./helper-scripts/backup_and_restore.sh backup all</span><br></pre></td></tr></table></figure></div><p><strong>建议使用定时脚本每天定时备份并同步到第三方机房加密保存</strong></p><p>一个简单的 crontab 定时脚本如下</p><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">5 3 * * * <span class="built_in">cd</span> /opt/mailcow-dockerized/; MAILCOW_BACKUP_LOCATION=/opt/backup /opt/mailcow-dockerized/helper-scripts/backup_and_restore.sh backup all</span><br></pre></td></tr></table></figure></div><p>具体备份命令可参考<a class="link" target="_blank" rel="noopener" href="https://mailcow.github.io/mailcow-dockerized-docs/backup_restore/b_n_r-backup/">官方教程 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p><h2 id="mailcow-的迁移">Mailcow 的迁移</h2><p>有时候我们需要更换服务器，因为基于 Docker 安装，迁移 Mailcow 是个很简单的事情。</p><h3 id="方法一直接迁移整个-docker">方法一：直接迁移整个 Docker</h3><p>首先，在需要迁移的服务器安装 Docker 和 Docker Compose，并确保两边的版本一致，然后停止 Docker 服务：</p><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">systemctl stop docker.service</span><br><span class="line">systemctl stop docker.socket</span><br></pre></td></tr></table></figure></div><p>使用 <code>systemctl status docker</code> 命令检查下 Docker 的状态：</p><figure><img lazyload src="/images/loading.svg" data-src="https://note.zhangyirui.cn/images/Self-built-domain-name-mailbox/image13.png" alt="image13.png"><figcaption aria-hidden="true">image13.png</figcaption></figure><p>然后从原来的机器把 Docker 容器和挂载的 Volumes 同步到新的机器：</p><p>新旧机器均需要安装 <code>rsync</code>：</p><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt install rsync -y</span><br></pre></td></tr></table></figure></div><p>旧的机器生成一个 SSH Key：</p><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t ed25519</span><br></pre></td></tr></table></figure></div><p>然后把 <code>/root/.ssh/id_ed25519.pub</code> 文件内容加到新机器的 <code>/root/.ssh/authorized_keys</code></p><p>然后同步 Mailcow 文件和 Docker 挂载的 Volumes：</p><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rsync -aHhP --numeric-ids --delete /opt/mailcow-dockerized/ root@新机器:/opt/mailcow-dockerized</span><br><span class="line">rsync -aHhP --numeric-ids --delete /var/lib/docker/volumes/ root@新机器:/var/lib/docker/volumes</span><br></pre></td></tr></table></figure></div><p>然后在原来的机器停止 Mailcow 容器：</p><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /opt/mailcow-dockerized</span><br><span class="line">docker compose down</span><br></pre></td></tr></table></figure></div><p>然后再次执行一次同步：</p><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rsync -aHhP --numeric-ids --delete /opt/mailcow-dockerized/ root@新机器:/opt/mailcow-dockerized</span><br><span class="line">rsync -aHhP --numeric-ids --delete /var/lib/docker/volumes/ root@新机器:/var/lib/docker/volumes</span><br></pre></td></tr></table></figure></div><p>然后在新的机器启动 Docker 服务：</p><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl start docker.service</span><br></pre></td></tr></table></figure></div><p>然后在新的机器启动 Mailcow 容器：</p><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /opt/mailcow-dockerized</span><br><span class="line">docker compose pull</span><br><span class="line">docker compose up -d</span><br></pre></td></tr></table></figure></div><p>记得迁移之前需要修改好 DNS 记录，解析到新的服务器 IP 即可。</p><p><em>这个迁移方法理论上适合任何使用 Docker 安装的软件</em></p><h3 id="方法二使用-mailcow-自带的备份和恢复脚本">方法二：使用 Mailcow 自带的备份和恢复脚本</h3><p>首先进入旧的服务器，然后进入 Mailcow 的目录，执行备份脚本：</p><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /opt/mailcow-dockerized</span><br><span class="line">./helper-scripts/backup_and_restore.sh backup all</span><br></pre></td></tr></table></figure></div><p>记得关闭 Mailcow 服务：</p><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker compose down</span><br></pre></td></tr></table></figure></div><p>然后把备份好的文件夹使用 <code>rsync</code> 同步到新的机器，这里假设你备份在 <code>/opt/backup</code> 目录：</p><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rsync -avz /opt/backup root@新机器:/opt</span><br></pre></td></tr></table></figure></div><p>然后进入新的机器，从头开始安装一次全新的 Mailcow，然后执行恢复脚本：</p><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /opt/mailcow-dockerized</span><br><span class="line">./helper-scripts/backup_and_restore.sh restore</span><br></pre></td></tr></table></figure></div><p>然后按照提示选择恢复的备份目录，比如 <code>/opt/backup</code> 即可。</p></div><div class="post-copyright-info w-full my-8 px-2 sm:px-6 md:px-8"><div class="article-copyright-info-container"><ul><li><strong>标题:</strong> Ubuntu 22.04 使用 Docker 安装 Mailcow 自建域名邮箱</li><li><strong>作者:</strong> 静凇</li><li><strong>创建于 :</strong> 2022-11-10 20:08:23</li><li><strong>更新于 :</strong> 2024-10-25 09:45:38</li><li><strong>链接:</strong> https://blog.zhangyirui.cn/2022/11/10/Self-built-domain-name-mailbox/</li><li><strong>版权声明: </strong>本文章采用 <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0">CC BY-NC-SA 4.0</a> 进行许可。</li></ul></div></div><ul class="post-tags-box text-lg mt-1.5 flex-wrap justify-center flex md:hidden"><li class="tag-item mx-0.5"><a href="/tags/Ubuntu/">#Ubuntu</a>&nbsp;</li><li class="tag-item mx-0.5"><a href="/tags/Mailcow/">#Mailcow</a>&nbsp;</li><li class="tag-item mx-0.5"><a href="/tags/%E8%87%AA%E5%BB%BA%E9%82%AE%E7%AE%B1/">#自建邮箱</a>&nbsp;</li></ul><div class="article-nav my-8 flex justify-between items-center px-2 sm:px-6 md:px-8"><div class="article-prev border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2"><a class="prev" rel="prev" href="/2022/11/26/portainer-first-experience/"><span class="left arrow-icon flex justify-center items-center"><i class="fa-solid fa-chevron-left"></i> </span><span class="title flex justify-center items-center"><span class="post-nav-title-item">Docker 之 Portainer 初体验</span> <span class="post-nav-item">上一篇</span></span></a></div><div class="article-next border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2"><a class="next" rel="next" href="/2022/10/25/Ubuntu-uninstall-docker/"><span class="title flex justify-center items-center"><span class="post-nav-title-item">在 Ubuntu 22.04 LTS 中卸载 Docker 和 Docker Compose</span> <span class="post-nav-item">下一篇</span> </span><span class="right arrow-icon flex justify-center items-center"><i class="fa-solid fa-chevron-right"></i></span></a></div></div></div><div class="toc-content-container"><div class="post-toc-wrap"><div class="post-toc"><div class="toc-title">目录</div><div class="page-title">Ubuntu 22.04 使用 Docker 安装 Mailcow 自建域名邮箱</div><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9C%AC%E6%96%87%E6%98%AF%E5%9C%A8-ubuntu-22.04-%E4%B8%AD%E4%BD%BF%E7%94%A8-docker-%E5%AE%89%E8%A3%85-mailcow-%E6%90%AD%E5%BB%BA%E8%87%AA%E5%BB%BA%E9%82%AE%E7%AE%B1%E7%9A%84%E6%95%99%E7%A8%8B"><span class="nav-text">本文是在 Ubuntu 22.04 中使用 Docker 安装 Mailcow 搭建自建邮箱的教程。</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E7%94%B5%E5%AD%90%E9%82%AE%E7%AE%B1"><span class="nav-text">什么是电子邮箱？</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E8%87%AA%E5%BB%BA%E9%82%AE%E7%AE%B1"><span class="nav-text">为什么要自建邮箱？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%87%AA%E5%BB%BA%E9%82%AE%E7%AE%B1%E7%9A%84%E4%BC%98%E5%8A%BF%E5%92%8C%E5%8A%A3%E5%8A%BF"><span class="nav-text">自建邮箱的优势和劣势</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%87%AA%E5%BB%BA%E9%82%AE%E7%AE%B1%E9%9C%80%E8%A6%81%E5%87%86%E5%A4%87%E7%9A%84%E8%B5%84%E6%96%99"><span class="nav-text">自建邮箱需要准备的资料</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%89%E8%A3%85-docker-%E5%92%8C-docker-compose"><span class="nav-text">安装 Docker 和 Docker Compose</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AE%BE%E7%BD%AE-dns-%E8%A7%A3%E6%9E%90%E8%AE%B0%E5%BD%95"><span class="nav-text">设置 DNS 解析记录</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%89%E8%A3%85-mailcow"><span class="nav-text">安装 Mailcow</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B7%BB%E5%8A%A0%E5%9F%9F%E5%90%8D%E5%92%8C%E9%82%AE%E7%AE%B1"><span class="nav-text">添加域名和邮箱</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BC%80%E5%90%AF-dkim-%E5%B9%B6%E6%B7%BB%E5%8A%A0-dns-%E8%AE%B0%E5%BD%95"><span class="nav-text">开启 DKIM 并添加 DNS 记录</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B7%BB%E5%8A%A0%E9%82%AE%E7%AE%B1%E7%94%A8%E6%88%B7"><span class="nav-text">添加邮箱用户</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B5%8B%E8%AF%95%E9%82%AE%E4%BB%B6"><span class="nav-text">测试邮件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#mailcow-%E7%9A%84%E6%9B%B4%E6%96%B0%E5%92%8C%E5%A4%87%E4%BB%BD"><span class="nav-text">Mailcow 的更新和备份</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#mailcow-%E7%9A%84%E8%BF%81%E7%A7%BB"><span class="nav-text">Mailcow 的迁移</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%B9%E6%B3%95%E4%B8%80%E7%9B%B4%E6%8E%A5%E8%BF%81%E7%A7%BB%E6%95%B4%E4%B8%AA-docker"><span class="nav-text">方法一：直接迁移整个 Docker</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%B9%E6%B3%95%E4%BA%8C%E4%BD%BF%E7%94%A8-mailcow-%E8%87%AA%E5%B8%A6%E7%9A%84%E5%A4%87%E4%BB%BD%E5%92%8C%E6%81%A2%E5%A4%8D%E8%84%9A%E6%9C%AC"><span class="nav-text">方法二：使用 Mailcow 自带的备份和恢复脚本</span></a></li></ol></li></ol></div></div></div></div></div></div><div class="main-content-footer"><footer class="footer mt-5 py-5 h-auto text-base text-third-text-color relative border-t-2 border-t-border-color"><div class="info-container py-3 text-center"><div class="customize-info my-1">我的生活我做主！</div><div class="text-center">&copy; <span>2022</span> - 2024&nbsp;&nbsp;<i class="fa-regular fa-computer-classic"></i>&nbsp;&nbsp;<a href="/">静凇</a></div><script data-swup-reload-script src="https://cn.vercount.one/js"></script><div class="relative text-center lg:absolute lg:right-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-right"><span id="busuanzi_container_site_uv" class="lg:!block"><span class="text-sm">访问人数</span> <span id="busuanzi_value_site_uv"></span> </span><span id="busuanzi_container_site_pv" class="lg:!block"><span class="text-sm">总访问量</span> <span id="busuanzi_value_site_pv"></span></span></div><div class="relative text-center lg:absolute lg:left-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-left"><span class="lg:block text-sm">由 <?xml version="1.0" encoding="utf-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg class="relative top-[2px] inline-block align-baseline" version="1.1" id="圖層_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="1rem" height="1rem" viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve"><path fill="#0E83CD" d="M256.4,25.8l-200,115.5L56,371.5l199.6,114.7l200-115.5l0.4-230.2L256.4,25.8z M349,354.6l-18.4,10.7l-18.6-11V275H200v79.6l-18.4,10.7l-18.6-11v-197l18.5-10.6l18.5,10.8V237h112v-79.6l18.5-10.6l18.5,10.8V354.6z"/></svg><a target="_blank" class="text-base" href="https://hexo.io">Hexo</a> 驱动</span> <span class="text-sm lg:block">主题&nbsp;<a class="text-base" target="_blank" href="https://github.com/EvanNotFound/hexo-theme-redefine">Redefine v2.7.1</a></span></div><div class="icp-info my-1"><a target="_blank" rel="nofollow" href="https://beian.miit.gov.cn/">冀ICP备2021026819号-1</a></div><div>博客已运行 <span class="odometer" id="runtime_days"></span> 天 <span class="odometer" id="runtime_hours"></span> 小时 <span class="odometer" id="runtime_minutes"></span> 分钟 <span class="odometer" id="runtime_seconds"></span> 秒</div><script data-swup-reload-script>try{function odometer_init(){document.querySelectorAll(".odometer").forEach(e=>{new Odometer({el:e,format:"( ddd).dd",duration:200})})}odometer_init()}catch(e){}</script></div></footer></div></div><div class="post-tools"><div class="post-tools-container"><ul class="article-tools-list"><li class="right-bottom-tools page-aside-toggle"><i class="fa-regular fa-outdent"></i></li></ul></div></div><div class="right-side-tools-container"><div class="side-tools-container"><ul class="hidden-tools-list"><li class="right-bottom-tools tool-font-adjust-plus flex justify-center items-center"><i class="fa-regular fa-magnifying-glass-plus"></i></li><li class="right-bottom-tools tool-font-adjust-minus flex justify-center items-center"><i class="fa-regular fa-magnifying-glass-minus"></i></li><li class="right-bottom-tools tool-dark-light-toggle flex justify-center items-center"><i class="fa-regular fa-moon"></i></li><li class="right-bottom-tools tool-scroll-to-bottom flex justify-center items-center"><i class="fa-regular fa-arrow-down"></i></li></ul><ul class="visible-tools-list"><li class="right-bottom-tools toggle-tools-list flex justify-center items-center"><i class="fa-regular fa-cog fa-spin"></i></li><li class="right-bottom-tools tool-scroll-to-top flex justify-center items-center"><i class="arrow-up fas fa-arrow-up"></i> <span class="percent"></span></li></ul></div></div><div class="image-viewer-container"><img src=""></div></main><script src="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.7.1/source/js/libs/Swup.min.js"></script><script src="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.7.1/source/js/libs/SwupSlideTheme.min.js"></script><script src="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.7.1/source/js/libs/SwupScriptsPlugin.min.js"></script><script src="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.7.1/source/js/libs/SwupProgressPlugin.min.js"></script><script src="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.7.1/source/js/libs/SwupScrollPlugin.min.js"></script><script src="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.7.1/source/js/libs/SwupPreloadPlugin.min.js"></script><script>const swup=new Swup({plugins:[new SwupScriptsPlugin({optin:!0}),new SwupProgressPlugin,new SwupScrollPlugin({offset:80}),new SwupSlideTheme({mainElement:".main-content-body"}),new SwupPreloadPlugin],containers:["#swup"]})</script><script type="module" src="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.7.1/source/js/tools/imageViewer.js"></script><script type="module" src="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.7.1/source/js/utils.js"></script><script type="module" src="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.7.1/source/js/main.js"></script><script type="module" src="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.7.1/source/js/layouts/navbarShrink.js"></script><script type="module" src="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.7.1/source/js/tools/scrollTopBottom.js"></script><script type="module" src="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.7.1/source/js/tools/lightDarkSwitch.js"></script><script type="module" src="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.7.1/source/js/layouts/categoryList.js"></script><script type="module" src="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.7.1/source/js/tools/codeBlock.js"></script><script type="module" src="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.7.1/source/js/layouts/lazyload.js"></script><script src="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.7.1/source/js/tools/runtime.js"></script><script src="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.7.1/source/js/libs/odometer.min.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.7.1/source/assets/odometer-theme-minimal.css"><script src="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.7.1/source/js/libs/Typed.min.js"></script><script type="module" src="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.7.1/source/js/plugins/typed.js"></script><script src="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.7.1/source/js/libs/mermaid.min.js"></script><script src="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.7.1/source/js/plugins/mermaid.js"></script><div class="post-scripts" data-swup-reload-script><script type="module" src="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.7.1/source/js/tools/tocToggle.js"></script><script type="module" src="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.7.1/source/js/layouts/toc.js"></script><script type="module" src="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.7.1/source/js/plugins/tabs.js"></script></div><div id="aplayer"></div><script src="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.7.1/source/js/libs/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/hexo-theme-redefine@2.7.1/source/js/plugins/aplayer.js"></script></body></html>